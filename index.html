<!doctype html>
<html>
  <head>
    <title>Socket.IO Rock Paper Scissors</title>
<script src="https://code.jquery.com/jquery-2.2.4.min.js" integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44=" crossorigin="anonymous"></script>
  </head>
  <body>
	<h1>Messages: <span id="messages"></span></h1>
	<h1>Player One: <span id="p1"></span></h1>
	<h1>Player Two: <span id="p2"></span></h1>
	<h2>You play...</h2>
	<input type="radio" name="uplay" value="rock">Rock
	<input type="radio" name="uplay" value="paper">Paper
	<input type="radio" name="uplay" value="scissors">Scissors
	<button>Send</button>
	<h1>Result: <span id="result"></span></h1>
	<!---
    <ul id="messages"></ul>
    <form action="">
      <input id="m" autocomplete="off" /><button>Send</button>
    </form>
	-->
	<script src="/socket.io/socket.io.js"></script>
	<script>
		var socket = io();
		var gamePacket = {};
		socket.on('welcome', msg => {
			$('#messages').text(msg.msg);
		});
		var radios = document.getElementsByName('uplay');
		for (radio in radios) {
			radios[radio].onclick = function() {
				if ($('#messages').text() == "You are player 1!!!") {
					$('#p1').text(this.value);
					gamePacket.player1 = this.value;
				} else if ($('#messages').text() == "You are player 2!!!") {
					$('#p2').text(this.value);
					gamePacket.player2 = this.value;
				}
				socket.emit('played', {gamePacket:gamePacket});
			}
		}
		socket.on('gameOver', data => {
			console.log(data.msg);
			if (data.msg === "Tie Game!") {
				$('#result').text("Tie Game!!!");
				if ($('#p1').text() === "") {
					$('#p1').text(data.game.player1);
				} else {
					$('#p2').text(data.game.player2);
				}
			} else {
				if ($('#p1').text() === "") { // I must be player 2 then
					if ($('#p2').text() === data.msg) {
						$('#result').text("You win!!!");
					} else {
						$('#result').text("You lose!!!");
					}
				} else if ($('#p2').text() === "") { // I must be player 1 then
					if ($('#p1').text() === data.msg) {
						$('#result').text("You win!!!");
					} else {
						$('#result').text("You lose!!!");
					}
				} else {
					console.error("Something bad happened...")
				}
				
			}
			
		})
		/*
		socket.on('otherplayer', data => {
			var otherplayer = data.other.gamePacket.player;
			if (otherplayer === 1) {
				$('#p1').text(data.other.gamePacket.choice);
			} else if (otherplayer === 2) {
				$('#p2').text(data.other.gamePacket.choice);
			} else {
				console.error('I don\'t know what happened.');
			}
			//console.log(declareWinner($('#p1').text(),$('#p2').text()));
		})
		*/
	</script>

  </body>
</html>
